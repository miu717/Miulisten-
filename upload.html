<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Upload | MiuListen</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body class="miu-theme">

  <!-- ğŸ”° Header -->
  <header class="header">
    <h2>â¬†ï¸ Upload Audio</h2>
    <button class="logout-btn" onclick="logout()">Logout</button>
  </header>

  <!-- ğŸ“¤ Upload Form -->
  <section style="padding: 16px;">
    <input type="text" id="title" placeholder="ğŸµ Title" required /><br /><br />

    <select id="category" required>
      <option value="">ğŸ“‚ Select Category</option>
      <option value="songs">ğŸ§ Songs</option>
      <option value="stories">ğŸ“– Stories</option>
      <option value="ringtones">ğŸ”” Ringtones</option>
      <option value="motivation">ğŸ™ï¸ Motivation</option>
      <option value="peaceful">ğŸ§˜ Peaceful</option>
      <option value="funny">ğŸ˜‚ Funny</option>
    </select><br /><br />

    <input type="file" id="audioFile" accept="audio/*" required /><br /><br />

    <input type="number" id="audioPrice" placeholder="â‚¹ Price (0 = Free)" /><br /><br />

    <button onclick="submitUpload()">ğŸ“¤ Upload Now</button>
  </section>

  <!-- JS Import -->
  <script type="module" src="firebase-config.js"></script>
  <script type="module" src="auth.js"></script>
  <script type="module" src="db.js"></script>
  <script type="module">
    import { uploadAudio } from "./db.js";

    window.logout = () => {
      import('./auth.js').then(m => m.logout());
    };

    window.submitUpload = async () => {
      const file = document.getElementById("audioFile").files[0];
      const title = document.getElementById("title").value;
      const category = document.getElementById("category").value;
      const price = parseInt(document.getElementById("audioPrice").value || "0");

      if (!file || !title || !category) {
        alert("Please fill all fields.");
        return;
      }

      await uploadAudio(file, title, category, price);
    };
  </script>
</body>
</html>
